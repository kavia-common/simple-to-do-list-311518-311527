{"is_source_file": true, "format": "Python", "description": "This file is a FastAPI backend implementation for a simple to-do list application. It defines API endpoints to create, read, update, complete, and delete tasks, using an SQLite database for persistence. The code includes schema definitions with Pydantic, database helper functions, and route handlers implementing CRUD operations and health checks.", "external_files": ["sqlite3", "os", "datetime", "typing", "fastapi", "fastapi.middleware.cors", "pydantic"], "external_methods": ["os.getenv", "sqlite3.connect", "datetime.now", "Timezone.utc", "BaseModel.Field", "fastapi.FastAPI", "fastapi.CORSMiddleware", "fastapi.HTTPException", "fastapi.Body", "fastapi.Path", "fastapi.Response", "fastapi.status"], "published": ["health_check", "list_tasks", "create_task", "replace_task", "set_task_completion", "delete_task"], "classes": [{"name": "TaskBase", "description": "Base model for task data with common fields (title, description)."}, {"name": "TaskCreate", "description": "Model for creating a new task, extends TaskBase with 'completed' field."}, {"name": "TaskUpdate", "description": "Model for updating an existing task fully, extends TaskBase with 'completed' field."}, {"name": "TaskOut", "description": "Model representing task data returned by API, includes id, timestamps, and completed status."}, {"name": "TaskListResponse", "description": "Wrapper for a list of task objects."}, {"name": "TaskCompleteResponse", "description": "Wrapper for a single task after marking complete/incomplete."}], "methods": [{"name": "str _utc_now_iso()", "description": "Returns current UTC timestamp in ISO format.", "scope": "", "scopeKind": ""}, {"name": "str _get_sqlite_path()", "description": "Retrieves SQLite database file path from environment variable or default.", "scope": "", "scopeKind": ""}, {"name": "sqlite3.Connection _get_conn()", "description": "Creates and returns a SQLite connection with row factory enabled.", "scope": "", "scopeKind": ""}, {"name": "None _init_db()", "description": "Initializes the database by creating 'tasks' table if absent.", "scope": "", "scopeKind": ""}, {"name": "TaskOut _row_to_task(row: sqlite3.Row)", "description": "Converts a SQLite row into a TaskOut model.", "scope": "", "scopeKind": ""}, {"name": "health_check()", "description": "Simple endpoint to verify the service health.", "scope": "", "scopeKind": ""}, {"name": "TaskListResponse list_tasks()", "description": "Retrieves all tasks from database, ordered by descending id.", "scope": "", "scopeKind": ""}, {"name": "TaskOut create_task( payload: TaskCreate = Body( ..., description=\"Task fields to create.\", examples=[ {\"title\": \"Buy groceries\", \"description\": \"Milk, eggs, bread\", \"completed\": False}, ], ) )", "description": "Creates a new task record based on provided data.", "scope": "", "scopeKind": ""}, {"name": "TaskOut replace_task( id: int = Path(..., ge=1, description=\"Task id.\"), payload: TaskUpdate = Body( ..., description=\"Full task fields to set.\", examples=[ {\"title\": \"Buy groceries\", \"description\": \"Milk, eggs, bread\", \"completed\": True}, ], ), )", "description": "Fully replaces an existing task with new data.", "scope": "", "scopeKind": ""}, {"name": "TaskCompleteResponse set_task_completion( id: int = Path(..., ge=1, description=\"Task id.\"), completed: bool = Body( ..., embed=True, description=\"Whether the task should be marked as completed.\", examples=[True], ), )", "description": "Updates the 'completed' status of a task.", "scope": "", "scopeKind": ""}, {"name": "Response delete_task(id: int = Path(..., ge=1, description=\"Task id.\"))", "description": "Deletes a task by its ID.", "scope": "", "scopeKind": ""}], "calls": ["_get_conn", "_row_to_task", "conn.execute", "conn.commit", "conn.close", "conn.execute"], "search-terms": ["FastAPI", "SQLite", "task CRUD", "to-do list backend", "API endpoints", "health check", "task models", "database init"], "state": 2, "file_id": 3, "knowledge_revision": 10, "git_revision": "1b04afdc3ef1dd6e84f5e6a7e5cf1d70fc6d7bd8", "revision_history": [{"9": "32e0d3e7518f3695f8298153bfe2dbc5faba2f92"}, {"10": "1b04afdc3ef1dd6e84f5e6a7e5cf1d70fc6d7bd8"}], "ctags": [{"_type": "tag", "name": "TaskBase", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^class TaskBase(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TaskCompleteResponse", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^class TaskCompleteResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TaskCreate", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^class TaskCreate(TaskBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TaskListResponse", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^class TaskListResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TaskOut", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^class TaskOut(TaskBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TaskUpdate", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^class TaskUpdate(TaskBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_get_conn", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def _get_conn() -> sqlite3.Connection:$/", "language": "Python", "typeref": "typename:sqlite3.Connection", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_get_sqlite_path", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def _get_sqlite_path() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_init_db", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def _init_db() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_row_to_task", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def _row_to_task(row: sqlite3.Row) -> TaskOut:$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "function", "signature": "(row: sqlite3.Row)"}, {"_type": "tag", "name": "_utc_now_iso", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def _utc_now_iso() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "completed", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    completed: bool = Field(..., description=\"Completion status.\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "TaskUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "completed", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    completed: bool = Field(..., description=\"Whether the task is completed.\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "TaskOut", "scopeKind": "class"}, {"_type": "tag", "name": "completed", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    completed: bool = Field(False, description=\"Initial completion status.\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "TaskCreate", "scopeKind": "class"}, {"_type": "tag", "name": "create_task", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def create_task($/", "language": "Python", "typeref": "typename:TaskOut", "kind": "function", "signature": "( payload: TaskCreate = Body( ..., description=\"Task fields to create.\", examples=[ {\"title\": \"Buy groceries\", \"description\": \"Milk, eggs, bread\", \"completed\": False}, ], ) )"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    created_at: str = Field(..., description=\"ISO-8601 UTC timestamp for creation.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "TaskOut", "scopeKind": "class"}, {"_type": "tag", "name": "delete_task", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def delete_task(id: int = Path(..., ge=1, description=\"Task id.\")) -> Response:$/", "language": "Python", "typeref": "typename:Response", "kind": "function", "signature": "(id: int = Path(..., ge=1, description=\"Task id.\"))"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    description: Optional[str] = Field($/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "TaskBase", "scopeKind": "class"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    id: int = Field(..., description=\"Unique task identifier.\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "TaskOut", "scopeKind": "class"}, {"_type": "tag", "name": "list_tasks", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def list_tasks() -> TaskListResponse:$/", "language": "Python", "typeref": "typename:TaskListResponse", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "openapi_tags", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^openapi_tags = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "replace_task", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def replace_task($/", "language": "Python", "typeref": "typename:TaskOut", "kind": "function", "signature": "( id: int = Path(..., ge=1, description=\"Task id.\"), payload: TaskUpdate = Body( ..., description=\"Full task fields to set.\", examples=[ {\"title\": \"Buy groceries\", \"description\": \"Milk, eggs, bread\", \"completed\": True}, ], ), )"}, {"_type": "tag", "name": "set_task_completion", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^def set_task_completion($/", "language": "Python", "typeref": "typename:TaskCompleteResponse", "kind": "function", "signature": "( id: int = Path(..., ge=1, description=\"Task id.\"), completed: bool = Body( ..., embed=True, description=\"Whether the task should be marked as completed.\", examples=[True], ), )"}, {"_type": "tag", "name": "task", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    task: TaskOut = Field(..., description=\"The updated task.\")$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "variable", "scope": "TaskCompleteResponse", "scopeKind": "class"}, {"_type": "tag", "name": "tasks", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    tasks: List[TaskOut] = Field(..., description=\"List of all tasks.\")$/", "language": "Python", "typeref": "typename:List[TaskOut]", "kind": "variable", "scope": "TaskListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    title: str = Field(..., min_length=1, max_length=200, description=\"Short title of the task.\"/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "TaskBase", "scopeKind": "class"}, {"_type": "tag", "name": "updated_at", "path": "/home/kavia/workspace/code-generation/simple-to-do-list-311518-311527/todo_backend/src/api/main.py", "pattern": "/^    updated_at: str = Field(..., description=\"ISO-8601 UTC timestamp for last update.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "TaskOut", "scopeKind": "class"}], "hash": "5f75971a90de9b0ac4158efbee89d52d", "format-version": 4, "code-base-name": "todo_backend", "filename": "todo_backend/src/api/main.py", "fields": [{"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool completed", "scope": "TaskUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "str created_at", "scope": "TaskOut", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] description", "scope": "TaskBase", "scopeKind": "class", "description": "unavailable"}, {"name": "int id", "scope": "TaskOut", "scopeKind": "class", "description": "unavailable"}, {"name": "openapi_tags = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TaskOut task", "scope": "TaskCompleteResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "List[TaskOut] tasks", "scope": "TaskListResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str title", "scope": "TaskBase", "scopeKind": "class", "description": "unavailable"}, {"name": "str updated_at", "scope": "TaskOut", "scopeKind": "class", "description": "unavailable"}]}